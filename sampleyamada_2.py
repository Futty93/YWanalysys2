# -*- coding: utf-8 -*-
"""SampleYamada-2.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1CrMoO4Iik3Gyu-SKvjXFAN944mKwSKrf

å·¦ã®ğŸ“‚ã‚’æŠ¼ã—ã¦ã€EXCELãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ‰ãƒ©ãƒƒã‚¯ï¼†ãƒ‰ãƒ­ãƒƒãƒ—ã§èª­ã¿è¾¼ã‚“ã§ãã ã•ã„
"""

##ãƒ•ã‚¡ã‚¤ãƒ«åã‚’å…¥åŠ›ï¼ï¼ï¼
FileName1 = "SampleExcel1.xlsx" #n=1
FileName2 = "SampleExcel2.xlsx" #n=2
FileName3 = "SampleExcel3.xlsx" #n=3

from IPython.utils import path
import openpyxl ##Excelã‚’èª­ã¿æ›¸ãã™ã‚‹ãŸã‚
import tqdm ##ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼ã‚’è¡¨ç¤ºã™ã‚‹ãŸã‚
from openpyxl.chart import( ##Excelã«ã‚°ãƒ©ãƒ•ã‚’æç”»ã™ã‚‹ãŸã‚
    ScatterChart,
    BarChart,
    Reference,
    Series,
)
from openpyxl.chart import Reference
from openpyxl.chart.axis import DateAxis
import numpy as np

"""â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã‚¨ãƒªã‚¢â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“"""
inputData = []
inputData.append(openpyxl.load_workbook(FileName1)) ##ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ã Open File.
inputData.append(openpyxl.load_workbook(FileName2)) ##ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ã Open File.
inputData.append(openpyxl.load_workbook(FileName3)) ##ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ã Open File.


samples = [] #ãã‚Œãã‚Œã®å€¤ã‚’èª­ã¿è¾¼ã‚€ãŸã‚ã®ç©ºã®é…åˆ—ã‚’æº–å‚™
"""samplesã¯3æ¬¡å…ƒé…åˆ—ã§ã€1ã¤ç›®ã®è¦ç´ ãŒn=1ã€2ã¤ç›®ãŒn=2ã¨å¯¾å¿œã™ã‚‹
    ãã‚Œãã‚Œã®è¦ç´ ã®1ã¤ç›®ãŒã‚µãƒ³ãƒ—ãƒ«1ã€2ã¤ç›®ãŒã‚µãƒ³ãƒ—ãƒ«2ã«å¯¾å¿œã—ã¦ã„ã‚‹"""
for i in range(3):
  samples.append([])
  for _ in range(2):
      samples[i].append([])
  for j in range(11): #å„ã‚µãƒ³ãƒ—ãƒ«ã®0ç•ªç›®ã®è¦ç´ ã‚’blankã¨ã—ã¦åˆ©ç”¨
    average1, average2 = 0, 0
    for k in range(3):
      #â‘  å„ãƒ•ã‚¡ã‚¤ãƒ«ã€å„ã‚µãƒ³ãƒ—ãƒ«ã€å„æ¿ƒåº¦ã§triplicateã®å¹³å‡ã‚’ç®—å‡ºã™ã‚‹
      average1 += inputData[i].active.cell(row=(11+k), column=(2+j)).value
      average2 += inputData[i].active.cell(row=(14+k), column=(2+j)).value
    samples[i][0].append(average1/3)
    samples[i][1].append(average2/3)

"""â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“ãƒ‡ãƒ¼ã‚¿ã®æ“ä½œã‚¨ãƒªã‚¢â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“"""
for i in range(3): #â‘¡ å„ãƒ•ã‚¡ã‚¤ãƒ«ã®å„ã‚µãƒ³ãƒ—ãƒ«ã€å„æ¿ƒåº¦ã§ã€Œå„æ¿ƒåº¦ã®å¹³å‡å€¤-blankã®å¹³å‡å€¤ã€ã‚’è¡Œã†
  for j in range(1, 11):
    samples[i][0][j] = samples[i][0][j] - samples[i][0][0]
    samples[i][1][j] = samples[i][1][j] - samples[i][1][0]
##samplesã®å„è¦ç´ ã«ã¯ï¼ç•ªç›®ã«blankã®å€¤ã€ãã®å¾Œã«ã¯ãã‚Œãã‚Œblankã‚’å¼•ã„ãŸå€¤ãŒå…¥ã£ã¦ã„ã‚‹

##å¹³å‡ã€æ¨™æº–åå·®ã€æ¨™æº–èª¤å·®ã‚’ä¿æŒã™ã‚‹é…åˆ—ã‚’ç”¨æ„
average, standardDeviation, standardError = [], [], []

#â‘¢ã€€â‘¡ã®å€¤ã®ãƒ•ã‚¡ã‚¤ãƒ«é–“ã§ã®å¹³å‡å€¤åŠã³æ¨™æº–åå·®ã‚’ç®—å‡ºã™ã‚‹
for i in range(2):
  average.append([])
  standardDeviation.append([])
  standardError.append([])
  for j in range(1, 11):
    List = []
    for k in range(3):
      List.append(samples[k][i][j])
    average[i].append((samples[0][i][j] + samples[1][i][j] + samples[2][i][j]) / 3)
    num = np.std(List)
    standardDeviation[i].append(num)
    standardError[i].append(num/np.sqrt(3))

print(average)
print(standardDeviation)
print(standardError)

# p = 0

# for i in range(14, 1154+19, 19): #14ã‹ã‚‰1154ã¾ã§19åˆ»ã¿ã§ç¹°ã‚Šè¿”ã™
#   blank.append([])
#   sample1.append([])
#   sample2.append([])
#   sample3.append([])
#   for j in range(3): #3ã¤ã®é€£ç¶šã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’ãã‚Œãã‚Œã®é…åˆ—ã«è¿½åŠ 
#     blank[p].append(inputData.active.cell(row=(i+j), column=9).value)
#     sample1[p].append(inputData.active.cell(row=(i+j), column=10).value)
#     sample2[p].append(inputData.active.cell(row=(i+j), column=11).value)
#     sample3[p].append(inputData.active.cell(row=(i+j), column=12).value)
  
#   p += 1

# # print(sample2)

# """â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“ãƒ‡ãƒ¼ã‚¿ã®æ“ä½œã‚¨ãƒªã‚¢â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“"""
# inputData.create_sheet("EditedData") #EditedDataã¨ã„ã†åå‰ã®ã‚·ãƒ¼ãƒˆã‚’ä½œæˆ

# for i in range(len(blank)): #â‘ å„è¡Œã«ã¤ã„ã¦ ã€Œã‚µãƒ³ãƒ—ãƒ«ã®å€¤-blankã®å€¤ã€ã‚’è¡Œã†
#   for j in range(3):
#     sample1[i][j] = sample1[i][j] - blank[i][j]
#     sample2[i][j] = sample2[i][j] - blank[i][j]
#     sample3[i][j] = sample3[i][j] - blank[i][j]
# # print(sample3)

# for i in range(len(sample1)): #â‘¡ â‘ ã®å€¤ã«ã¤ã„ã¦triplicateã§å¹³å‡ã‚’ç®—å‡ºã™ã‚‹
#   inputData["EditedData"].cell(row=1, column=2).value = "control"
#   inputData["EditedData"].cell(row=1, column=3).value = "ACP1b"
#   inputData["EditedData"].cell(row=1, column=4).value = "242a"
#   inputData["EditedData"].cell(row=i+2, column=1).value = i
#   sample1[i] = (sample1[i][0] + sample1[i][1] + sample1[i][2])/3
#   inputData["EditedData"].cell(row=i+2, column=2).value = sample1[i]
#   sample2[i] = (sample2[i][0] + sample2[i][1] + sample2[i][2])/3
#   inputData["EditedData"].cell(row=i+2, column=3).value = sample2[i]
#   sample3[i] = (sample3[i][0] + sample3[i][1] + sample3[i][2])/3
#   inputData["EditedData"].cell(row=i+2, column=4).value = sample3[i]
# # print(sample1)


# """â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“ã‚°ãƒ©ãƒ•ã®æç”»ã‚¨ãƒªã‚¢â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“"""
# graph = openpyxl.chart.LineChart() #ã‚°ãƒ©ãƒ•ã®ç¨®é¡
# # graph.title  = "Sample" #ã‚°ãƒ©ãƒ•ã®ã‚¿ã‚¤ãƒˆãƒ«  å¿…è¦ãªã‚‰å…¥åŠ›ã—ã¦ãã ã•ã„
# graph.style  = 12 #ã‚°ãƒ©ãƒ•ã®ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚º
# graph.height = 10 #é«˜ã•
# graph.width  = 15 #å¹…

# graph.y_axis.title = inputData.sheetnames[0] #yè»¸ãƒ©ãƒ™ãƒ«
# yValue = Reference(inputData["EditedData"],min_col = 2, min_row = 1, max_col = 4, max_row = 62)
# xValue = Reference(inputData["EditedData"],min_col = 1, min_row = 2, max_row = 62)

# graph.add_data(yValue, titles_from_data=True) ##yè»¸ã®ãƒ‡ãƒ¼ã‚¿
# graph.set_categories(xValue) ##xè»¸ã®ãƒ‡ãƒ¼ã‚¿
# graph.y_axis.numFmt = "0" ##ç¸¦è»¸ã®ãƒ©ãƒ™ãƒ«ã®æ›¸å¼æŒ‡å®š å°æ•°ç¬¬2ä½ã¾ã§è¡¨ç¤º

# inputData["EditedData"].add_chart(graph, "E2") ##E2ã«ã‚°ãƒ©ãƒ•ã‚’æç”» Draw a graph at position E2

# #X-Yè»¸(1)ã‚°ãƒ©ãƒ•ã‚¹ã‚¿ã‚¤ãƒ«
# style = graph.series[0]
# style.graphicalProperties.line.solidFill = "AAAAAA"   #ã‚°ãƒ©ãƒ•ã‚«ãƒ©ãƒ¼
# style.graphicalProperties.line.width = 40000          #ã‚°ãƒ©ãƒ•å¹…
# # style.smooth = False                                   #ã‚°ãƒ©ãƒ•ã®ç·šã‚’æ»‘ã‚‰ã‹ã«ã™ã‚‹

# #X-Yè»¸(2)ã‚°ãƒ©ãƒ•ã‚¹ã‚¿ã‚¤ãƒ«
# style2 = graph.series[1]
# style2.graphicalProperties.line.solidFill = "5B9BD5"  #ã‚°ãƒ©ãƒ•ã‚«ãƒ©ãƒ¼
# style2.graphicalProperties.line.width = 40000         #ã‚°ãƒ©ãƒ•å¹…
# # style2.smooth = True                                  #ã‚°ãƒ©ãƒ•ã®ç·šã‚’æ»‘ã‚‰ã‹ã«ã™ã‚‹

# style3 = graph.series[2]
# style3.graphicalProperties.line.solidFill = "ED7D31"  #ã‚°ãƒ©ãƒ•ã‚«ãƒ©ãƒ¼
# style3.graphicalProperties.line.width = 40000         #ã‚°ãƒ©ãƒ•å¹…
# # style3.smooth = True                                  #ã‚°ãƒ©ãƒ•ã®ç·šã‚’æ»‘ã‚‰ã‹ã«ã™ã‚‹



# inputData.save("Edited_" + FileName) ##ã‚¨ã‚¯ã‚»ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¿å­˜ Save Excel file
# inputData.close() ##ã‚¨ã‚¯ã‚»ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‰ã˜ã‚‹ Close Excel file